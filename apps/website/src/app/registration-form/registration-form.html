<app-header>
  <div slot="end" class="flex items-center gap-4">
        <span class="text-sm text-muted-foreground">
          Need help? <a href="#" class="text-primary hover:underline">Support Center</a>
        </span>
    <button
      hlmBtn
      variant="outline"
      (click)="saveAndExit()"
      class="text-sm">
      Save & Exit
    </button>
  </div>
</app-header>

<div class="min-h-screen bg-gray-50 pt-15">
  <div class="flex gap-0 px-2 md:px-10 lg:px-20 mx-auto">
    <!-- Sidebar Stepper -->
    <aside class="w-80 bg-white border-r border-gray-200 min-h-[calc(100vh-73px)] p-8">
      <nav class="space-y-2">
        @for (step of steps(); track step.id; let i = $index) {
          <div
            class="flex border-s-6 items-start gap-4 p-4 rounded-lg transition-colors cursor-pointer"
            [class.bg-primary/10]="currentStep() === i"
            [class.border-primary]="currentStep() === i"
            [class.border-success/10]="step.completed && currentStep() !== i"
            [class.border-success]="step.completed && currentStep() === i"
            [class.bg-success/10]="step.completed && currentStep() === i"
            [class.hover:bg-gray-50]="currentStep() !== i"
            (click)="currentStep.set(i)">

            <!-- Icon/Check -->
          <div
            class="w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 transition-colors"
            [class.bg-success/20]="step.completed"
            [class.text-success]="step.completed"
            [class.bg-primary]="currentStep() === i && !step.completed"
            [class.text-white]="currentStep() === i && !step.completed"
            [class.bg-gray-100]="currentStep() !== i && !step.completed"
            [class.text-gray-400]="currentStep() !== i && !step.completed">
          @if (step.completed) {
            <ng-icon name="lucideCheck" size="20" />
          } @else {
            <ng-icon [name]="step.icon" size="20" />
          }
          </div>

          <!-- Text -->
          <div class="flex-1 min-w-0">
            <h3
              class="font-semibold text-sm mb-0.5"
              [class.text-primary]="currentStep() === i"
              [class.text-success]="step.completed"
              [class.text-foreground]="currentStep() !== i">
              {{ step.title }}
            </h3>
            <p
              class="text-xs text-muted-foreground"
              [class.text-success/80]="step.completed"

            >{{ step.subtitle }}</p>
          </div>
          </div>
        }
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-8 md:p-12">
      <div>

        @switch (currentStep()) {
          @case (0) {
            <app-profile-info-step
              [(registrationId)]="registrationId"
              [(formValue)]="profileInfoValue"
              [fieldErrors]="fieldErrors()"
              (formSubmitted)="onProfileInfoSubmit()"
            />
          }
          @case (1) {
            <app-institution-details-step
              [registrationId]="registrationId() ?? ''"
              [(formValue)]="institutionDetailsValue"
              (formSubmitted)="onInstitutionDetailsSubmit()"
              (back)="previousStep()"
            />
          }
          @case (2) {
            <app-documents-step
              [(formValue)]="documentsValue"
              [(isValid)]="documentsValid"
              [isLoading]="isLoading()"
              [fieldErrors]="fieldErrors()"
              (submitForm)="onDocumentsSubmit($event)"
              (back)="previousStep()"
            />
          }
          @case (3) {
            <app-admin-credentials-step
              [(formValue)]="adminCredentialsValue"
              [(isValid)]="adminCredentialsValid"
              [isLoading]="isLoading()"
              [fieldErrors]="fieldErrors()"
              (submitForm)="onAdminCredentialsSubmit($event)"
              (back)="previousStep()"
            />
          }
        }
      </div>
    </main>
  </div>

  <!-- Footer -->
  <footer class="border-t border-gray-200 bg-white px-4 md:px-10 lg:px-20 py-6">
    <div class="flex items-center justify-between text-xs text-muted-foreground max-w-7xl mx-auto">
      <p>
        Â© 2024 EduReg Global. All rights reserved.
        @if (currentStep() === 3) {
          All administrative actions are logged for security purposes. Data encryption is active.
        } @else {
          Your data is protected by end-to-end encryption.
        }
      </p>
      @if (currentStep() === 2) {
        <div class="flex items-center gap-2 text-green-600">
          <ng-icon hlmIcon name="lucideShieldCheck" size="base" />
          <span class="font-medium">SSL SECURE CONNECTION</span>
        </div>
      }
    </div>
  </footer>
</div>
