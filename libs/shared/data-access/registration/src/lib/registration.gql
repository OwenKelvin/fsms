# Registration Mutations

mutation SubmitProfileInfo($input: ProfileInfoInput!, $registrationId: Int) {
  submitProfileInfo(input: $input, registrationId: $registrationId) {
    success
    registrationId
    message
    errors {
      field
      message
    }
  }
}

mutation SubmitInstitutionDetails($registrationId: Int!, $input: InstitutionDetailsInput!) {
  submitInstitutionDetails(registrationId: $registrationId, input: $input) {
    success
    registrationId
    message
    errors {
      field
      message
    }
  }
}

mutation UploadDocument($file: Upload!, $input: DocumentUploadInput!) {
  uploadRegistrationDocument(file: $file, input: $input) {
    success
    documentId
    fileUploadId
    documentType
    fileName
    fileSize
    message
    errors {
      field
      message
    }
  }
}

mutation SubmitAdminCredentials($registrationId: Int!, $input: AdminCredentialsInput!) {
  submitAdminCredentials(registrationId: $registrationId, input: $input) {
    success
    registrationId
    message
    errors {
      field
      message
    }
  }
}

mutation CompleteRegistration(
  $registrationId: Int!
  $profileInfo: ProfileInfoInput!
  $institutionDetails: InstitutionDetailsInput!
  $adminCredentials: AdminCredentialsInput!
) {
  completeRegistration(
    registrationId: $registrationId
    profileInfo: $profileInfo
    institutionDetails: $institutionDetails
    adminCredentials: $adminCredentials
  ) {
    success
    institutionId
    adminUserId
    message
    errors {
      field
      message
    }
  }
}

# Registration Queries

query GetRegistrationStatus($registrationId: Int!) {
  getRegistrationStatus(registrationId: $registrationId) {
    id
    status
    profileInfoCompleted
    institutionDetailsCompleted
    documentsUploaded
    adminCredentialsCompleted
    createdAt
    updatedAt
    completedAt
    institutionId
    adminUserId
  }
}

query GetRegistrationDetails($registrationId: Int!) {
  getRegistrationDetails(registrationId: $registrationId) {
    id
    status
    profileInfoCompleted
    institutionDetailsCompleted
    documentsUploaded
    adminCredentialsCompleted
    createdAt
    updatedAt
    completedAt
    institutionId
    adminUserId
    institution {
      id
      legalName
      institutionType
      accreditationNumber
      streetAddress
      city
      stateProvince
      zipPostalCode
      officialWebsite
    }
    adminUser {
      id
      firstName
      lastName
      email
    }
    statusHistory {
      id
      previousStatus
      newStatus
      changedAt
      changedBy
      notes
    }
  }
}

query GetRegistrations($filter: RegistrationFilterInput) {
  getRegistrations(filter: $filter) {
    id
    status
    profileInfoCompleted
    institutionDetailsCompleted
    documentsUploaded
    adminCredentialsCompleted
    createdAt
    updatedAt
    completedAt
    institutionId
    adminUserId
    institution {
      id
      legalName
      institutionType
    }
    adminUser {
      id
      firstName
      lastName
      email
    }
  }
}

query GetRegistrationsRequiringReview {
  getRegistrationsRequiringReview {
    id
    status
    profileInfoCompleted
    institutionDetailsCompleted
    documentsUploaded
    adminCredentialsCompleted
    createdAt
    updatedAt
    completedAt
    institutionId
    adminUserId
    institution {
      id
      legalName
      institutionType
    }
    adminUser {
      id
      firstName
      lastName
      email
    }
    statusHistory {
      id
      previousStatus
      newStatus
      changedAt
      changedBy
      notes
    }
  }
}
